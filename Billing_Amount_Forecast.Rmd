---
title: "Predictive Health Care"
author: "Rachael Kawira"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Predicting the Billing Amount in Health Care

This is dataset was downloaded from Kaggle <https://www.kaggle.com/datasets/prasad22/healthcare-dataset> which shows the Name,Age, Gender, Bloodtype, Medical condition, Date of Admission, doctor, Hospital, Insurance provider, Billing amount, room number, admission type, Discharge date, medication and test results.

```{r overview}
library(readxl)
Healthcare_dataset <- read_excel("D:/Desktop/Healthcare_dataset.xlsx")
View(Healthcare_dataset)
summary(Healthcare_dataset)
```

## Forecasting the Billing Amount

To be able to forecast the billing amount, its paramount to understand the data types we are dealing with:

```{r data, echo=FALSE}
str(Healthcare_dataset)
```
Ensure that the date parameter is saved as a date type.
``` {r date}
Healthcare_dataset$`Date of Admission` <- as.Date(Healthcare_dataset$ `Date of Admission`)
```
In order to predict the data you need to have the data in a grouped timely manner that is either daily, monthly or yearly inorder to have a sufficient time series to model from:
``` {r ts, echo=FALSE}
library(dplyr)
monthly_billing <- Healthcare_dataset %>%
group_by(month = format(`Date of Admission`, "%Y-%m")) %>%
summarise(total_billing = sum(`Billing Amount`, na.rm = TRUE))
print(monthly_billing)
```
Create then the time series sequence:
``` {r ts_model, echo=FALSE}
monthly_billing$month <- as.Date(paste0(monthly_billing$month, "-01"))
start_year <- as.numeric(format(min(monthly_billing$month), "%Y"))
start_month <- as.numeric(format(min(monthly_billing$month), "%m"))
monthly_billing_ts <- ts(monthly_billing$total_billing, start = c(start_year, start_month), frequency = 12)
print(monthly_billing_ts)
```
We can then forecast the Billing amount that we can get in the future months using an ARIMA model:
``` {r forecast, echo=FALSE}
install.packages("forecast")
library(forecast)
fit_arima <- auto.arima(monthly_billing_ts)
forecasted_values <- forecast(fit_arima, h = 12)
plot(forecasted_values)
```